
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bingo C√¥ng D√¢n S·ªë 2026 - T·∫øt B√≠nh Ng·ªç</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        body {
            font-family: 'Quicksand', sans-serif;
            background-color: #8b0000;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            overflow: hidden;
        }
        .aspect-16-9 {
            width: 100%;
            max-width: 1280px;
            aspect-ratio: 16 / 9;
            background-color: #fef2f2;
            position: relative;
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 100px rgba(0,0,0,0.5);
            border: 4px solid #eab308;
        }
        @media (max-aspect-ratio: 16/9) {
            .aspect-16-9 {
                width: 100vw;
                height: auto;
                aspect-ratio: 16 / 9;
            }
        }
        .bingo-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.5rem;
            height: 100%;
        }
        .cell-selected {
            background-color: #eab308 !important;
            border-color: #ffffff !important;
            color: #8b0000 !important;
            transform: scale(0.95);
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.2);
        }
        @keyframes bounce-subtle {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        .animate-bounce-subtle {
            animation: bounce-subtle 2s infinite ease-in-out;
        }
        .quiz-modal {
            display: none;
            position: fixed;
            inset: 0;
            z-index: 100;
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(8px);
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }
        .quiz-content {
            background: white;
            width: 90%;
            height: 85%;
            max-width: 1100px;
            border-radius: 3rem;
            border: 8px solid #eab308;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }
    </style>
</head>
<body>

<div class="aspect-16-9 md:rounded-3xl overflow-hidden flex flex-col">
    <!-- Header -->
    <header class="bg-red-700 py-3 px-6 shadow-lg text-center border-b-4 border-yellow-400 flex justify-between items-center shrink-0">
        <div class="text-yellow-400 text-xl md:text-2xl font-bold">üêé T·∫æT B√çNH NG·ªå</div>
        <h1 class="text-xl md:text-4xl font-black text-yellow-300 drop-shadow-lg tracking-widest uppercase">BINGO C√îNG D√ÇN S·ªê</h1>
        <div class="text-yellow-400 text-xl md:text-2xl font-bold">2026 üé†</div>
    </header>

    <!-- Main Content -->
    <main class="flex-1 flex overflow-hidden p-4 gap-6">
        <!-- Grid Area -->
        <div class="flex-[1.2] flex flex-col justify-center items-center h-full relative">
            <div id="grid-container" class="bg-red-600 p-3 rounded-[2rem] shadow-2xl border-4 border-yellow-400 w-full max-w-[550px] aspect-square relative">
                <div id="bingo-grid" class="bingo-grid h-full">
                    <!-- Cells will be generated by JS -->
                </div>
                <!-- Win Overlay -->
                <div id="win-overlay" class="hidden absolute inset-0 bg-red-700/95 rounded-[1.8rem] flex flex-col items-center justify-center text-center p-6 z-20 border-4 border-yellow-400">
                    <div class="text-7xl mb-4 animate-bounce">üèÜ</div>
                    <h2 class="text-4xl md:text-6xl font-black text-yellow-300 mb-2 italic">BINGO!</h2>
                    <p class="text-white text-xl font-bold uppercase tracking-widest">C√îNG D√ÇN S·ªê TH√îNG TH√ÅI</p>
                    <button onclick="initGame()" class="mt-8 bg-yellow-400 hover:bg-yellow-500 text-red-800 font-black py-4 px-12 rounded-full shadow-lg uppercase text-xl transition-all active:scale-95">CH∆†I L·∫†I</button>
                </div>
            </div>
        </div>

        <!-- Sidebar -->
        <div class="flex-1 flex flex-col gap-4 py-4 pr-2">
            <div class="bg-white rounded-3xl border-4 border-red-600 p-6 shadow-xl flex flex-col items-center text-center justify-center flex-1">
                <h3 class="text-xl font-black text-red-700 mb-4 uppercase">üé≤ L∆Ø·ª¢T TI·∫æP THEO</h3>
                <button id="draw-btn" onclick="openQuiz()" class="w-full py-8 px-6 rounded-3xl font-black text-2xl bg-red-600 hover:bg-red-700 text-white shadow-[0_8px_0_rgb(150,0,0)] border-2 border-yellow-400 active:translate-y-2 active:shadow-none animate-bounce-subtle transition-all">
                    üßß M·ªû L√å X√å MAY M·∫ÆN
                </button>
                <div class="mt-8 w-full">
                    <div class="flex justify-between text-xs font-bold text-red-800 uppercase mb-2">
                        <span>Ti·∫øn ƒë·ªô b·ªëc thƒÉm</span>
                        <span id="progress-text">0 / 20</span>
                    </div>
                    <div class="w-full h-4 bg-red-100 rounded-full border border-red-200 overflow-hidden">
                        <div id="progress-bar" class="h-full bg-red-600 transition-all duration-500" style="width: 0%"></div>
                    </div>
                </div>
            </div>
            <div class="bg-yellow-100 p-4 rounded-3xl border-2 border-yellow-500 shadow-md">
                <h4 class="font-black text-red-700 mb-2 uppercase text-sm">üìñ C√ÅCH CH∆†I</h4>
                <p class="text-xs text-red-900 font-bold leading-relaxed">NƒÉm m·ªõi 2026 r·ª±c r·ª°! B·ªëc l√¨ x√¨ ‚ûî Tr·∫£ l·ªùi ƒë√∫ng ‚ûî √î Bingo s·∫Ω t·ª± ƒë·ªông s√°ng l√™n!</p>
            </div>
            <button onclick="initGame()" class="bg-white hover:bg-gray-100 text-red-700 font-black py-3 px-6 rounded-2xl border-2 border-red-600 transition-all text-sm uppercase">üîÑ ƒê·ªîI TH·∫∫ M·ªöI</button>
        </div>
    </main>

    <footer class="bg-red-800 py-2 px-6 text-center text-yellow-200 font-bold text-xs shrink-0 border-t-2 border-yellow-500">
        ¬© 2026 STEM EDUCATION - VUI T·∫æT AN TO√ÄN TR√äN KH√îNG GIAN M·∫†NG
    </footer>
</div>

<!-- Quiz Modal -->
<div id="quiz-modal" class="quiz-modal">
    <div class="quiz-content">
        <div class="bg-red-700 p-6 text-center border-b-4 border-yellow-500">
            <h2 class="text-2xl md:text-4xl font-black text-yellow-300 uppercase tracking-widest">üßß TH·ª¨ TH√ÅCH C√îNG D√ÇN S·ªê 2026 üßß</h2>
        </div>
        <div class="flex-1 p-8 md:p-12 flex flex-col items-center justify-center overflow-y-auto">
            <div id="quiz-icon" class="text-7xl md:text-8xl mb-6">üîê</div>
            <h3 id="quiz-question" class="text-xl md:text-3xl font-black text-red-900 text-center mb-10 max-w-4xl leading-tight">C√¢u h·ªèi s·∫Ω xu·∫•t hi·ªán ·ªü ƒë√¢y?</h3>
            <div id="quiz-options" class="grid grid-cols-1 md:grid-cols-3 gap-6 w-full max-w-5xl">
                <!-- Options generated by JS -->
            </div>
            <div id="quiz-feedback" class="mt-8 h-20 flex flex-col items-center justify-center text-center">
                <!-- Feedback generated by JS -->
            </div>
        </div>
        <div class="p-6 bg-red-50 border-t-4 border-red-100 flex justify-center">
            <button id="close-quiz-btn" onclick="closeQuiz()" class="hidden py-4 px-16 rounded-full font-black text-2xl bg-red-600 text-white hover:bg-red-700 border-4 border-yellow-400 shadow-lg uppercase tracking-widest transition-all">X√ÅC NH·∫¨N</button>
        </div>
        <button onclick="closeQuiz()" class="absolute top-4 right-8 text-white text-5xl font-black hover:scale-125 transition-transform">√ó</button>
    </div>
</div>

<script>
    const BINGO_ITEMS = [
        { id: '1', keyword: 'M·∫≠t kh·∫©u m·∫°nh', icon: 'üîê', explanation: 'S·ª≠ d·ª•ng m·∫≠t kh·∫©u kh√≥ ƒëo√°n nh∆∞ "NguaVang2026!@" ƒë·ªÉ b·∫£o v·ªá t√†i kho·∫£n m·∫°nh m·∫Ω.', question: 'M·∫≠t kh·∫©u n√†o d∆∞·ªõi ƒë√¢y l√† an to√†n nh·∫•t cho nƒÉm m·ªõi 2026?', options: ['12345678', 'ten_cua_em', 'NguaVang2026!@#'], correctAnswer: 2 },
        { id: '2', keyword: 'Kh√¥ng chia s·∫ª th√¥ng tin', icon: 'üôÖ', explanation: 'ƒê·ª´ng bao gi·ªù n√≥i ƒë·ªãa ch·ªâ nh√† hay s·ªë ƒëi·ªán tho·∫°i cho ng∆∞·ªùi l·∫° tr√™n m·∫°ng.', question: 'Ng∆∞·ªùi l·∫° tr√™n m·∫°ng h·ªèi ƒë·ªãa ch·ªâ nh√† em ƒë·ªÉ g·ª≠i qu√† T·∫øt, em n√™n l√†m g√¨?', options: ['Cung c·∫•p ngay ƒë·ªÉ nh·∫≠n qu√†', 'T·ª´ ch·ªëi v√† b√°o cho cha m·∫π', 'H·ªèi xem qu√† l√† g√¨ r·ªìi m·ªõi cho'], correctAnswer: 1 },
        { id: '3', keyword: 'L·ªùi ch√∫c t·ª≠ t·∫ø', icon: 'üíå', explanation: 'G·ª≠i nh·ªØng l·ªùi ch√∫c t·ªët ƒë·∫πp ƒë·∫øn b·∫°n b√®, ng∆∞·ªùi th√¢n qua m·∫°ng x√£ h·ªôi.', question: 'Khi th·∫•y b·∫°n ƒëƒÉng ·∫£nh ƒëi ch∆°i T·∫øt, em n√™n b√¨nh lu·∫≠n nh∆∞ th·∫ø n√†o?', options: ['Ch√™ ·∫£nh x·∫•u qu√°', 'Ch√∫c b·∫°n nƒÉm m·ªõi vui v·∫ª', 'Kh√¥ng n√≥i g√¨'], correctAnswer: 1 },
        { id: '4', keyword: 'Tho√°t t√†i kho·∫£n', icon: 'üö™', explanation: 'Lu√¥n ƒëƒÉng xu·∫•t sau khi s·ª≠ d·ª•ng m√°y t√≠nh ·ªü tr∆∞·ªùng ho·∫∑c n∆°i c√¥ng c·ªông.', question: 'Sau khi d√πng m√°y t√≠nh ·ªü th∆∞ vi·ªán, em c·∫ßn l√†m g√¨ tr∆∞·ªõc khi v·ªÅ?', options: ['T·∫Øt m√†n h√¨nh l√† xong', 'C·ª© ƒë·ªÉ th·∫ø r·ªìi v·ªÅ', 'ƒêƒÉng xu·∫•t t√†i kho·∫£n'], correctAnswer: 2 },
        { id: '5', keyword: 'H·ªèi √Ω ki·∫øn cha m·∫π', icon: 'üôã', explanation: 'Lu√¥n xin ph√©p ng∆∞·ªùi l·ªõn tr∆∞·ªõc khi t·∫£i b·∫•t k·ª≥ tr√≤ ch∆°i hay ·ª©ng d·ª•ng n√†o.', question: 'Em mu·ªën t·∫£i m·ªôt tr√≤ ch∆°i m·ªõi tr√™n m·∫°ng, em n√™n l√†m g√¨?', options: ['T·ª± b·∫•m t·∫£i ngay', 'Xin ph√©p cha m·∫π/th·∫ßy c√¥', 'R·ªß b·∫°n c√πng t·∫£i'], correctAnswer: 1 },
        { id: '6', keyword: 'Link l·∫°', icon: 'üîó', explanation: 'C·∫£nh gi√°c v·ªõi c√°c ƒë∆∞·ªùng link "Nh·∫≠n L√¨ X√¨ Kh·ªßng" gi·∫£ m·∫°o.', question: 'Tin nh·∫Øn: "B·∫•m v√†o ƒë√¢y ƒë·ªÉ nh·∫≠n l√¨ x√¨ 5 tri·ªáu". Em n√™n l√†m g√¨?', options: ['B·∫•m ngay k·∫ªo h·∫øt', 'G·ª≠i cho c√°c b·∫°n', 'X√≥a tin v√¨ ƒë√≥ l√† l·ª´a ƒë·∫£o'], correctAnswer: 2 },
        { id: '7', keyword: 'Webcam', icon: 'üì∑', explanation: 'T·∫Øt ho·∫∑c che webcam khi kh√¥ng s·ª≠ d·ª•ng ƒë·ªÉ b·∫£o v·ªá s·ª± ri√™ng t∆∞.', question: 'T·∫°i sao n√™n che webcam khi kh√¥ng s·ª≠ d·ª•ng m√°y t√≠nh?', options: ['ƒê·ªÉ kh√¥ng b·ªã b·ª•i', 'ƒê·ªÉ tr√°nh b·ªã k·∫ª x·∫•u quay l√©n', 'ƒê·ªÉ m√°y ch·∫°y nhanh h∆°n'], correctAnswer: 1 },
        { id: '8', keyword: 'K·∫øt b·∫°n an to√†n', icon: 'ü§ù', explanation: 'Ch·ªâ k·∫øt b·∫°n v·ªõi nh·ªØng ng∆∞·ªùi m√† em th·ª±c s·ª± bi·∫øt r√µ ngo√†i ƒë·ªùi.', question: 'M·ªôt ng∆∞·ªùi l·∫° g·ª≠i l·ªùi m·ªùi k·∫øt b·∫°n, em n√™n l√†m g√¨?', options: ['ƒê·ªìng √Ω ngay', 'Ch·ªâ ƒë·ªìng √Ω n·∫øu bi·∫øt r√µ h·ªç', 'ƒê·ªÉ ƒë√≥ kh√¥ng l√†m g√¨'], correctAnswer: 1 },
        { id: '9', keyword: 'Tin gi·∫£', icon: 'üßê', explanation: 'Ki·ªÉm ch·ª©ng th√¥ng tin tr∆∞·ªõc khi tin t∆∞·ªüng ho·∫∑c chia s·∫ª cho ng∆∞·ªùi kh√°c.', question: 'Th·∫•y tin ƒë·ªìn "Ng√†y mai ƒë∆∞·ª£c ngh·ªâ h·ªçc" tr√™n m·∫°ng, em l√†m g√¨?', options: ['Chia s·∫ª ngay', 'H·ªèi cha m·∫π ƒë·ªÉ x√°c nh·∫≠n', 'Tin l√† th·∫≠t v√† ngh·ªâ h·ªçc'], correctAnswer: 1 },
        { id: '10', keyword: 'D·∫•u ch√¢n s·ªë', icon: 'üë£', explanation: 'M·ªói vi·ªác em l√†m tr√™n m·∫°ng ƒë·ªÅu ƒë·ªÉ l·∫°i d·∫•u v·∫øt m√£i m√£i.', question: 'D·∫•u ch√¢n s·ªë (Digital Footprint) l√† g√¨?', options: ['D·∫•u ch√¢n c·ªßa robot', 'Th√¥ng tin em ƒë·ªÉ l·∫°i tr√™n m·∫°ng', 'M·ªôt tr√≤ ch∆°i ƒëi·ªán t·ª≠'], correctAnswer: 1 },
        { id: '11', keyword: 'B·∫Øt n·∫°t qua m·∫°ng', icon: 'üõ°Ô∏è', explanation: 'N·∫øu th·∫•y ai ƒë√≥ b·ªã b·∫Øt n·∫°t, h√£y b√°o ngay cho ng∆∞·ªùi l·ªõn.', question: 'N·∫øu th·∫•y b·∫°n b·ªã ng∆∞·ªùi kh√°c n√≥i x·∫•u tr√™n m·∫°ng, em l√†m g√¨?', options: ['V√†o h√πa n√≥i x·∫•u c√πng', 'Im l·∫∑ng b·ªè qua', 'B√°o cho cha m·∫π/th·∫ßy c√¥'], correctAnswer: 2 },
        { id: '12', keyword: 'Th·ªùi gian h·ª£p l√Ω', icon: '‚è≥', explanation: 'Kh√¥ng n√™n d√πng m√°y t√≠nh qu√° l√¢u, h√£y d√†nh th·ªùi gian ch∆°i c√πng gia ƒë√¨nh.', question: 'D√πng m√°y t√≠nh bao l√¢u m·ªói ng√†y l√† h·ª£p l√Ω?', options: ['C·∫£ ng√†y kh√¥ng ngh·ªâ', '30-60 ph√∫t v√† ngh·ªâ gi·∫£i lao', 'Kh√¥ng bao gi·ªù d√πng'], correctAnswer: 1 },
        { id: '13', keyword: 'Virus m√°y t√≠nh', icon: 'ü¶†', explanation: 'C·∫©n th·∫≠n v·ªõi c√°c ph·∫ßn m·ªÅm l·∫°, ch√∫ng c√≥ th·ªÉ l√†m h·ªèng m√°y t√≠nh.', question: 'M√°y t√≠nh b·ªã nhi·ªÖm "Virus" th∆∞·ªùng do ƒë√¢u?', options: ['Do b·ªã b·ª•i', 'Do b·∫•m link l·∫° ho·∫∑c t·∫£i file l·∫°', 'Do d√πng qu√° nhi·ªÅu'], correctAnswer: 1 },
        { id: '14', keyword: 'Email', icon: 'üìß', explanation: 'H√≤m th∆∞ ƒëi·ªán t·ª≠ gi√∫p em trao ƒë·ªïi th√¥ng tin h·ªçc t·∫≠p an to√†n.', question: 'Nh·∫≠n email t·ª´ ng∆∞·ªùi l·∫° c√≥ ƒë√≠nh k√®m file, em l√†m g√¨?', options: ['M·ªü file ra ngay', 'X√≥a email v√† kh√¥ng m·ªü file', 'G·ª≠i cho b·∫°n b√®'], correctAnswer: 1 },
        { id: '15', keyword: 'Internet', icon: 'üåê', explanation: 'Th·∫ø gi·ªõi Internet r·ªông l·ªõn v√† th√∫ v·ªã n·∫øu bi·∫øt d√πng ƒë√∫ng c√°ch.', question: 'Internet mang l·∫°i l·ª£i √≠ch g√¨ cho vi·ªác h·ªçc t·∫≠p?', options: ['Ch·ªâ ƒë·ªÉ ch∆°i game', 'Tra c·ª©u ki·∫øn th·ª©c v√† h·ªçc t·∫≠p', 'ƒê·ªÉ tr·ªën l√†m b√†i t·∫≠p'], correctAnswer: 1 },
        { id: '16', keyword: 'Robot', icon: 'ü§ñ', explanation: 'H·ªçc l·∫≠p tr√¨nh Robot gi√∫p em th√¥ng minh v√† s√°ng t·∫°o h∆°n.', question: 'Robot c√≥ th·ªÉ gi√∫p con ng∆∞·ªùi vi·ªác g√¨?', options: ['L√†m c√°c vi·ªác nguy hi·ªÉm', 'Thay th·∫ø ho√†n to√†n con ng∆∞·ªùi', 'Ch·ªâ ƒë·ªÉ trang tr√≠'], correctAnswer: 0 },
        { id: '17', keyword: 'B√¨nh lu·∫≠n l·ªãch s·ª±', icon: 'üí¨', explanation: 'Lu√¥n d√πng ng√¥n t·ª´ nh√£ nh·∫∑n khi b√¨nh lu·∫≠n tr√™n m·∫°ng.', question: 'Khi kh√¥ng ƒë·ªìng √Ω v·ªõi b·∫°n tr√™n m·∫°ng, em l√†m g√¨?', options: ['M·∫Øng b·∫°n l√† ƒë·ªì ng·ªëc', 'Gi·∫£i th√≠ch nh·∫π nh√†ng', 'D√πng t·ª´ ng·ªØ th√¥ t·ª•c'], correctAnswer: 1 },
        { id: '18', keyword: 'T√†i kho·∫£n c√° nh√¢n', icon: 'üë§', explanation: 'Gi·ªØ b√≠ m·∫≠t t√™n ƒëƒÉng nh·∫≠p v√† m·∫≠t kh·∫©u nh∆∞ gi·ªØ ti·ªÅn l√¨ x√¨!', question: 'C√≥ n√™n cho b·∫°n m∆∞·ª£n t√†i kho·∫£n h·ªçc t·∫≠p kh√¥ng?', options: ['C√≥, b·∫°n th√¢n l√† ph·∫£i chia s·∫ª', 'Kh√¥ng, c·∫ßn b·∫£o m·∫≠t c√° nh√¢n', 'Cho m∆∞·ª£n n·∫øu b·∫°n tr·∫£ ti·ªÅn'], correctAnswer: 1 },
        { id: '19', keyword: 'M√£ QR an to√†n', icon: 'üî≥', explanation: 'Ch·ªâ qu√©t c√°c m√£ QR t·ª´ ngu·ªìn tin c·∫≠y.', question: 'Th·∫•y m√£ QR "Qu√©t ƒë·ªÉ nh·∫≠n qu√†" d√°n ngo√†i ƒë∆∞·ªùng, em l√†m g√¨?', options: ['Qu√©t ngay xem qu√† g√¨', 'Kh√¥ng qu√©t v√¨ c√≥ th·ªÉ l·ª´a ƒë·∫£o', 'R·ªß c·∫£ l·ªõp c√πng qu√©t'], correctAnswer: 1 },
        { id: '20', keyword: 'Chia s·∫ª ni·ªÅm vui', icon: 'üèÆ', explanation: 'ƒêƒÉng nh·ªØng t·∫•m h√¨nh T·∫øt ·∫•m c√∫ng ƒë·ªÉ lan t·ªèa h·∫°nh ph√∫c.', question: 'Tr∆∞·ªõc khi ƒëƒÉng ·∫£nh c√≥ m·∫∑t b·∫°n l√™n m·∫°ng, em c·∫ßn l√†m g√¨?', options: ['ƒêƒÉng lu√¥n', 'H·ªèi √Ω ki·∫øn xem b·∫°n ƒë·ªìng √Ω kh√¥ng', 'G·∫Øn th·∫ª b·∫°n th·∫≠t nhi·ªÅu'], correctAnswer: 1 }
    ];

    const WIN_COMBINATIONS = [
        [0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15],
        [0, 4, 8, 12], [1, 5, 9, 13], [2, 6, 10, 14], [3, 7, 11, 15],
        [0, 5, 10, 15], [3, 6, 9, 12]
    ];

    let gridItems = [];
    let history = [];
    let currentQuizItem = null;
    let isWinner = false;

    function shuffle(array) {
        let currentIndex = array.length, randomIndex;
        while (currentIndex != 0) {
            randomIndex = Math.floor(Math.random() * currentIndex);
            currentIndex--;
            [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
        }
        return array;
    }

    function initGame() {
        const shuffled = shuffle([...BINGO_ITEMS]).slice(0, 16);
        gridItems = shuffled.map(item => ({ ...item, isSelected: false }));
        history = [];
        isWinner = false;
        document.getElementById('win-overlay').classList.add('hidden');
        renderGrid();
        updateProgress();
    }

    function renderGrid() {
        const gridEl = document.getElementById('bingo-grid');
        gridEl.innerHTML = '';
        gridItems.forEach((item, index) => {
            const cell = document.createElement('div');
            cell.id = `cell-${item.id}`;
            cell.className = `relative transition-all duration-500 rounded-xl flex flex-col items-center justify-center text-center border-2 aspect-square overflow-hidden ${item.isSelected ? 'cell-selected' : 'bg-white border-red-200'}`;
            cell.innerHTML = `
                <span class="text-2xl md:text-3xl mb-1 ${item.isSelected ? 'animate-bounce' : ''}">${item.icon}</span>
                <span class="text-[8px] md:text-[10px] font-black uppercase leading-tight px-1 ${item.isSelected ? 'text-red-700' : 'text-red-900'}">${item.keyword}</span>
            `;
            gridEl.appendChild(cell);
        });
    }

    function updateProgress() {
        document.getElementById('progress-text').innerText = `${history.length} / ${BINGO_ITEMS.length}`;
        document.getElementById('progress-bar').style.width = `${(history.length / BINGO_ITEMS.length) * 100}%`;
    }

    function openQuiz() {
        if (isWinner) return;
        const remaining = BINGO_ITEMS.filter(item => !history.includes(item.id));
        if (remaining.length === 0) {
            alert("ƒê√£ b·ªëc h·∫øt t·∫•t c·∫£ l√¨ x√¨!");
            return;
        }
        currentQuizItem = remaining[Math.floor(Math.random() * remaining.length)];
        
        document.getElementById('quiz-icon').innerText = currentQuizItem.icon;
        document.getElementById('quiz-question').innerText = currentQuizItem.question;
        
        const optionsContainer = document.getElementById('quiz-options');
        optionsContainer.innerHTML = '';
        currentQuizItem.options.forEach((opt, idx) => {
            const btn = document.createElement('button');
            btn.className = "p-6 rounded-[2rem] text-lg md:text-xl font-black transition-all border-4 shadow-xl bg-red-50 border-red-200 hover:border-yellow-500 hover:bg-yellow-50 hover:scale-105 text-red-900 flex flex-col items-center justify-center min-h-[140px]";
            btn.innerHTML = `<div class="mb-2 text-3xl">${idx === 0 ? 'üÖ∞Ô∏è' : idx === 1 ? 'üÖ±Ô∏è' : '¬©Ô∏è'}</div>${opt}`;
            btn.onclick = () => handleAnswer(idx, btn);
            optionsContainer.appendChild(btn);
        });

        document.getElementById('quiz-feedback').innerHTML = '';
        document.getElementById('close-quiz-btn').classList.add('hidden');
        document.getElementById('quiz-modal').style.display = 'flex';
    }

    function handleAnswer(idx, btn) {
        const btns = document.querySelectorAll('#quiz-options button');
        btns.forEach(b => b.disabled = true);

        if (idx === currentQuizItem.correctAnswer) {
            btn.className = "p-6 rounded-[2rem] text-xl font-black transition-all border-4 shadow-xl bg-green-500 border-green-700 text-white scale-110 rotate-1 flex flex-col items-center justify-center min-h-[140px]";
            document.getElementById('quiz-feedback').innerHTML = `<p class="text-green-600 font-black text-2xl italic">CH√çNH X√ÅC! üåü</p><p class="text-gray-700 font-bold">${currentQuizItem.explanation}</p>`;
            
            history.push(currentQuizItem.id);
            updateProgress();
            
            // Mark cell in grid
            const gridItem = gridItems.find(i => i.id === currentQuizItem.id);
            if (gridItem) {
                gridItem.isSelected = true;
                renderGrid();
                checkWin();
            }
        } else {
            btn.className = "p-6 rounded-[2rem] text-xl font-black transition-all border-4 shadow-xl bg-red-600 border-red-800 text-white opacity-50 grayscale flex flex-col items-center justify-center min-h-[140px]";
            document.getElementById('quiz-feedback').innerHTML = `<p class="text-red-600 font-black text-2xl italic">·ªêI! SAI R·ªíI üèÆ</p><p class="text-gray-600 font-bold">H√£y th·ª≠ l·∫°i ·ªü l∆∞·ª£t sau nh√©!</p>`;
        }
        document.getElementById('close-quiz-btn').classList.remove('hidden');
    }

    function closeQuiz() {
        document.getElementById('quiz-modal').style.display = 'none';
    }

    function checkWin() {
        const selectedIndices = gridItems.map((item, idx) => item.isSelected ? idx : -1).filter(idx => idx !== -1);
        const hasWon = WIN_COMBINATIONS.some(combo => combo.every(idx => selectedIndices.includes(idx)));
        
        if (hasWon && !isWinner) {
            isWinner = true;
            document.getElementById('win-overlay').classList.remove('hidden');
            triggerFireworks();
        }
    }

    function triggerFireworks() {
        const duration = 5 * 1000;
        const animationEnd = Date.now() + duration;
        const defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };
        const randomInRange = (min, max) => Math.random() * (max - min) + min;

        const interval = setInterval(function() {
            const timeLeft = animationEnd - Date.now();
            if (timeLeft <= 0) return clearInterval(interval);
            const particleCount = 50 * (timeLeft / duration);
            confetti({ ...defaults, particleCount, origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 } });
            confetti({ ...defaults, particleCount, origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 } });
        }, 250);
    }

    // Start Game
    initGame();
</script>
</body>
</html>
